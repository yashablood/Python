import tkinter as tk
from tkinter import ttk


class DataEntryApp(tk.Tk):
    def __init__(self):
        super().__init__()
        self.title("Professional Data Entry")
        self.geometry("700x600")
        self.resizable(True, True)

        # Configure rows and columns to stretch
        self.columnconfigure(0, weight=1)
        self.rowconfigure(0, weight=1)

        # Main Container
        container = ttk.Frame(self)
        container.grid(padx=10, pady=10, sticky="nsew")

        # Scrollable Area
        canvas = tk.Canvas(container)
        scrollbar = ttk.Scrollbar(container, orient="vertical", command=canvas.yview)
        self.scrollable_frame = ttk.Frame(canvas)

        # Bind the scrollable frame to the canvas
        self.scrollable_frame.bind(
            "<Configure>",
            lambda e: canvas.configure(scrollregion=canvas.bbox("all")),
        )

        canvas.create_window((0, 0), window=self.scrollable_frame, anchor="nw")
        canvas.configure(yscrollcommand=scrollbar.set)

        # Place canvas and scrollbar
        canvas.grid(row=0, column=0, sticky="nsew")
        scrollbar.grid(row=0, column=1, sticky="ns")

        # Configure stretching
        container.columnconfigure(0, weight=1)
        container.rowconfigure(0, weight=1)

        # Create the content
        self.create_sections()

    def create_sections(self):
        """Create UI sections."""
        # File Selection Section
        file_frame = ttk.LabelFrame(self.scrollable_frame, text="Excel File")
        file_frame.grid(row=0, column=0, pady=10, padx=10, sticky="ew")
        select_file_btn = ttk.Button(file_frame, text="Select File")
        select_file_btn.pack(fill="x", padx=10, pady=5)

        # Metrics Entry Section
        form_frame = ttk.LabelFrame(self.scrollable_frame, text="Metrics Entry")
        form_frame.grid(row=1, column=0, pady=10, padx=10, sticky="ew")
        form_frame.columnconfigure(1, weight=1)

        labels = [
            "Days without Incident",
            "Haz ID's",
            "Safety Gemba Walk",
            "7S (Zone 26)",
            "7S (Zone 51)",
            "Errors",
            "Productivity",
            "OTIF %",
        ]
        self.entries = {}

        for idx, label_text in enumerate(labels):
            label = ttk.Label(form_frame, text=label_text)
            label.grid(row=idx, column=0, pady=5, padx=10, sticky="w")

            entry = ttk.Entry(form_frame)
            entry.grid(row=idx, column=1, pady=5, padx=10, sticky="ew")
            self.entries[label_text] = entry

        # Submit Button Section
        submit_btn = ttk.Button(self.scrollable_frame, text="Submit", command=self.submit_data)
        submit_btn.grid(row=2, column=0, pady=20, padx=10, sticky="ew")

    def submit_data(self):
        """Handle form submission."""
        data = {label: entry.get() for label, entry in self.entries.items()}
        print("Submitted Data:", data)


if __name__ == "__main__":
    app = DataEntryApp()
    app.mainloop()
